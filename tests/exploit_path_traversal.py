from flask import Flask, send_file, make_response

app = Flask(__name__)

@app.route('/obter_imagem')
def obter_imagem():
    # Caminho para o arquivo da imagem (certifique-se de ter uma imagem chamada teste_imagem.png no mesmo diretório)
    caminho_imagem = 'tests/teste_imagem.png'

    # Define o cabeçalho Content-Disposition com o nome de arquivo desejado
    filename = '../teste_imagem.py'

    # Lê o conteúdo da imagem
    with open(caminho_imagem, 'rb') as img_file:
        img_data = img_file.read()

    # Cria uma resposta Flask
    resposta = make_response(img_data)
    
    # Define os cabeçalhos
    resposta.headers['Content-Type'] = 'image/png'
    resposta.headers['Content-Disposition'] = f'attachment; filename={filename}'

    return resposta

if __name__ == '__main__':
    # Executa o aplicativo na porta 8080
    app.run(port=8080)
